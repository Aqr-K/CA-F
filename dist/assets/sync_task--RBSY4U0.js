import{a as D,S as I,r,q as F,v as J,b as M,e as l,o as d,h as y,i as s,w as o,L as b,g as O,D as P,E as g,K as v,Y as k,Z as u,a8 as h,x as R,F as C,j as x,c as _,$,a9 as j,C as q,_ as K}from"./index-vNit1Wt3.js";import{S as Y}from"./variable-BbLTKFSv.js";const Z={key:0},z={class:"btn-settings"},A=D({__name:"sync_task",setup(G){const V=I.useToast(),S=r(!0),a=r({...Y}),f=r(""),c=r([{task_name:""}]),U=F(()=>c.value.map(t=>t.task_name)),i=r(c[0]),N=r([{key:"symlink_creator",label:"更新软链接"},{key:"metadata_copyer",label:"更新元数据"},{key:"metadata_covered",label:"元数据覆盖"},{key:"symlink_dir_checker",label:"无效文件夹"},{key:"symlink_checker",label:"无效软链接"},{key:"metadata_checker",label:"无效元数据"}]),w=r([{key:"sync_mode",label:"同步模式",options:["常规同步","星标同步","目录树同步"]},{key:"metadata_copyer_mode",label:"元数据模式",options:["下载模式","本地模式"]},{key:"num_threads",label:"同步线程数"}]);async function B(){try{const t=await v.get("/autosymlink/sync_list");c.value=t,a.value=c.value[0],i.value=a.value.task_name,f.value=a.value.media_dir,S.value=!1}catch(t){console.error("Error fetching sync config:",t)}}async function E(){try{const t=await v.post("/autosymlink/start_task",a.value);t.success?V.success(t.message):V.error(t.message)}catch(t){console.error("Error fetching sync config:",t)}}function L(t){const n=c.value.find(p=>p.task_name===t);n?(a.value=JSON.parse(JSON.stringify(n)),f.value=a.value.media_dir):console.log("Template config not found")}return J(B),(t,n)=>{const p=M("VPathInput");return l(a).id?(d(),y("div",Z,[s(b,{class:"px-5 mb-5",title:"目录配置"},{default:o(()=>[s(k,{class:"p-5"},{default:o(()=>[s(u,{cols:"7"},{default:o(()=>[s(h,{label:"选择配置",items:l(U),modelValue:l(i),"onUpdate:modelValue":[n[0]||(n[0]=e=>R(i)?i.value=e:null),L]},null,8,["items","modelValue"])]),_:1}),s(u,{cols:"12"},{default:o(()=>[s(p,{label:"选择文件夹",modelValue:l(a).media_dir,"onUpdate:modelValue":n[1]||(n[1]=e=>l(a).media_dir=e),currentDir:l(f)},null,8,["modelValue","currentDir"])]),_:1})]),_:1})]),_:1}),s(b,{class:"px-5 mb-5",title:"同步功能"},{default:o(()=>[s(k,{class:"p-5"},{default:o(()=>[s(u,{cols:"7"},{default:o(()=>[s(k,null,{default:o(()=>[(d(!0),y(C,null,x(l(N),(e,m)=>(d(),_(u,{cols:"12",md:"6"},{default:o(()=>[s($,{label:e.label,modelValue:l(a)[e.key],"onUpdate:modelValue":T=>l(a)[e.key]=T,class:"p-0 m-0"},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1}),(d(!0),y(C,null,x(l(w),e=>(d(),_(u,{cols:"7"},{default:o(()=>["options"in e?(d(),_(h,{key:0,id:e.label,label:e.label,items:e.options,modelValue:l(a)[e.key],"onUpdate:modelValue":m=>l(a)[e.key]=m},null,8,["id","label","items","modelValue","onUpdate:modelValue"])):typeof l(a)[e.key]=="string"||typeof l(a)[e.key]=="number"?(d(),_(j,{key:1,id:e.label,label:e.label,modelValue:l(a)[e.key],"onUpdate:modelValue":m=>l(a)[e.key]=m},null,8,["id","label","modelValue","onUpdate:modelValue"])):g("",!0)]),_:2},1024))),256))]),_:1})]),_:1}),O("div",z,[s(P,{onClick:E},{default:o(()=>n[2]||(n[2]=[q("开始同步")])),_:1})])])):g("",!0)}}}),W=K(A,[["__scopeId","data-v-0df06802"]]);export{W as default};
